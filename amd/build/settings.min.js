define("plagiarism_safeassign/settings",["exports","jquery","core/modal_factory","core/templates","core/str","core/ajax"],(function(_exports,_jquery,_modal_factory,_templates,_str,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * This file is part of Moodle - http://moodle.org/
   *
   * Moodle is free software: you can redistribute it and/or modify
   * it under the terms of the GNU General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * Moodle is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
   *
   * @author    Jonathan Garcia Gomez jonathan.garcia@openlms.net
   * @copyright Copyright (c) 2017 Open LMS / 2023 Anthology Inc. and its affiliates
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory),_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax);var _default={init:function(storedUrl){const inputs="#id_safeassign_api, #id_safeassign_instructor_username, #id_safeassign_instructor_password, #id_safeassign_student_username, #id_safeassign_student_password",disableButton=function(string){(0,_jquery.default)("#id_test_credentials").attr("disabled","disabled"),(0,_jquery.default)("#id_test_credentials").attr("value",string)},buttonText=(0,_str.get_string)("button_disabled","plagiarism_safeassign");_jquery.default.when(buttonText).done((function(localizedString){(0,_jquery.default)(inputs).each((function(){""==(0,_jquery.default)(this).val()&&disableButton(localizedString)})),(0,_jquery.default)(inputs).on("input",(function(){disableButton(localizedString)}));(0,_jquery.default)("#id_safeassign_api").val()!=storedUrl&&disableButton(localizedString)}));const swapClasses=function(selector,status){status?(0,_jquery.default)(selector).hasClass("alert-warning")?(0,_jquery.default)(selector).removeClass("alert-warning").addClass("alert-success"):(0,_jquery.default)(selector).hasClass("alert-danger")&&(0,_jquery.default)(selector).removeClass("alert-danger").addClass("alert-success"):(0,_jquery.default)(selector).hasClass("alert-warning")?(0,_jquery.default)(selector).removeClass("alert-warning").addClass("alert-danger"):(0,_jquery.default)(selector).hasClass("alert-success")&&(0,_jquery.default)(selector).removeClass("alert-success").addClass("alert-danger")},credentialsTrigger=(0,_jquery.default)("#id_test_credentials"),strings=(0,_str.get_strings)([{key:"test_credentials",component:"plagiarism_safeassign"},{key:"safeassign_credentials_verified",component:"plagiarism_safeassign"},{key:"safeassign_credentials_fail",component:"plagiarism_safeassign"}]);let localizedStrings=[];_jquery.default.when(strings).done((function(localizedEditString){localizedStrings=localizedEditString,_modal_factory.default.create({title:localizedEditString[0],body:_templates.default.render("plagiarism_safeassign/modal",{}),type:_modal_factory.default.types.DEFAULT},credentialsTrigger)}));const setDefault=function(selector){(0,_jquery.default)(selector).hasClass("alert-success")?(0,_jquery.default)(selector).removeClass("alert-success").addClass("alert-warning"):(0,_jquery.default)(selector).hasClass("alert-danger")&&(0,_jquery.default)(selector).removeClass("alert-danger").addClass("alert-warning")},testCredentials=function(resultText,resultElement,username,password,baseUrl,userId){_ajax.default.call([{methodname:"plagiarism_safeassign_test_api_credentials",args:{username:username,password:password,baseurl:baseUrl,userid:userId}}])[0].done((function(response){response.success?(swapClasses(resultElement,!0),(0,_jquery.default)(resultText).text(localizedStrings[1])):(swapClasses(resultElement,!1),(0,_jquery.default)(resultText).text(localizedStrings[2]))})).fail((function(){swapClasses(resultElement,!1),(0,_jquery.default)(resultText).text(localizedStrings[2])}))};credentialsTrigger.click((function(e){e.preventDefault(),setDefault("#instructor_credentials"),(0,_jquery.default)("#instructor_result").text("..."),setDefault("#student_credentials"),(0,_jquery.default)("#student_result").text("...");const instructorUsername=(0,_jquery.default)("#id_safeassign_instructor_username").val(),instructorPassword=(0,_jquery.default)("#id_safeassign_instructor_password").val(),studentUsername=(0,_jquery.default)("#id_safeassign_student_username").val(),studentPassword=(0,_jquery.default)("#id_safeassign_student_password").val(),userId=(0,_jquery.default)("input[name=userid]").val(),baseUrl=(0,_jquery.default)("#id_safeassign_api").val();testCredentials("#instructor_result","#instructor_credentials",instructorUsername,instructorPassword,baseUrl,userId),testCredentials("#student_result","#student_credentials",studentUsername,studentPassword,baseUrl,userId)}));const cleanSelect=(0,_jquery.default)("#id_safeassign_additional_roles");cleanSelect.find("option").length>1&&cleanSelect.change((function(){(0,_jquery.default)("option:selected").each((function(){0==(0,_jquery.default)(this).val()&&cleanSelect.val(0)}))}))}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=settings.min.js.map